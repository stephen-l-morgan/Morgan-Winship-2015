----------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/stephenmorgan/GitHub/steve-simulations/morgan-figure-4-3-sim-01.log
  log type:  text
 opened on:  21 Aug 2020, 16:49:28

. 
. *******************************************************************************
. *** set the number of observations
. *******************************************************************************
. 
. set obs 1000000
number of observations (_N) was 0, now 1,000,000

. 
. *******************************************************************************
. *** generate data
. *******************************************************************************
. 
. gen u = rnormal()

. gen v = rnormal()

. gen ytminus1 = u + v + rnormal()

. 
. gen dindex = -1 + v

. gen trueps = exp(dindex)/(1+exp(dindex))

. gen d = rbinomial(1, trueps)

. * gen d = v + rnormal() /* alternative linear d */
. 
. gen y0 = 20 + u + ytminus1 + rnormal()

. gen dshock = rnormal()

. gen ite = 1 + dshock

. gen y1 = y0 + ite

. gen y = (1-d)*y0 + d*y1

. * gen y = 10 + u + ytminus1 + d + rnormal() /* alternative w/o potential o's */
. 
. *******************************************************************************
. *** summary statistics for simulated data
. *******************************************************************************
. 
. summ

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
           u |  1,000,000   -.0004108    .9995836  -4.409075   4.934386
           v |  1,000,000    .0006099    .9993627  -4.655128   4.525112
    ytminus1 |  1,000,000     .001571    1.731631  -9.086295   9.040772
      dindex |  1,000,000   -.9993901    .9993627  -5.655128   3.525112
      trueps |  1,000,000    .3033245    .1825842   .0034873   .9713939
-------------+---------------------------------------------------------
           d |  1,000,000      .30315    .4596197          0          1
          y0 |  1,000,000    19.99929    2.645581    5.56675   34.71345
      dshock |  1,000,000    .0006444    .9991962    -4.8967   5.171278
         ite |  1,000,000    1.000644    .9991962    -3.8967   6.171278
          y1 |  1,000,000    20.99994    2.827606   6.876979   35.41351
-------------+---------------------------------------------------------
           y |  1,000,000    20.30169    2.805734    5.56675   34.71345

. 
. /*
> preserve
> 
> sample 10000, count
> 
> dotplot u v ytminus1 d y
> graph export tmp431.pdf, replace
> 
> kdensity y, nograph generate(x fx)
> kdensity y if d==0, nograph generate(fx0) at(x)
> kdensity y if d==1, nograph generate(fx1) at(x)
> label var fx0 "Control"
> label var fx1 "Treatment"
> line fx0 fx1 x, sort ytitle(Density)
> graph export tmp432.pdf, replace
> 
> restore
> */
. 
. mean y0 ite y1 u v d y ytminus1, over(d)

Mean estimation                   Number of obs   =  1,000,000

            0: d = 0
            1: d = 1

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
y0           |
           0 |      19.74       0.00         19.74       19.75
           1 |      20.59       0.00         20.58       20.60
-------------+------------------------------------------------
ite          |
           0 |       1.00       0.00          1.00        1.00
           1 |       1.00       0.00          0.99        1.00
-------------+------------------------------------------------
y1           |
           0 |      20.74       0.00         20.74       20.75
           1 |      21.59       0.01         21.58       21.60
-------------+------------------------------------------------
u            |
           0 |      -0.00       0.00         -0.00        0.00
           1 |       0.00       0.00         -0.00        0.00
-------------+------------------------------------------------
v            |
           0 |      -0.25       0.00         -0.26       -0.25
           1 |       0.59       0.00          0.58        0.59
-------------+------------------------------------------------
d            |
           0 |       0.00  (omitted)
           1 |       1.00       0.00             .           .
-------------+------------------------------------------------
y            |
           0 |      19.74       0.00         19.74       19.75
           1 |      21.59       0.01         21.58       21.60
-------------+------------------------------------------------
ytminus1     |
           0 |      -0.25       0.00         -0.26       -0.25
           1 |       0.59       0.00          0.58        0.60
--------------------------------------------------------------

. corr y0 ite y1 u v d y ytminus1
(obs=1,000,000)

             |       y0      ite       y1        u        v        d        y ytminus1
-------------+------------------------------------------------------------------------
          y0 |   1.0000
         ite |  -0.0004   1.0000
          y1 |   0.9355   0.3530   1.0000
           u |   0.7560  -0.0004   0.7072   1.0000
           v |   0.3774   0.0010   0.3535  -0.0003   1.0000
           d |   0.1471  -0.0021   0.1369   0.0010   0.3873   1.0000
           y |   0.9672   0.1070   0.9428   0.7130   0.4195   0.3021   1.0000
    ytminus1 |   0.8729   0.0005   0.8169   0.5778   0.5764   0.2242   0.8601   1.0000


. 
. *******************************************************************************
. *** set up macros for specifications
. *******************************************************************************
. 
. global outcome "y"

. global treatment "d"

. 
. global short " "

. global correct "v"

. 
. global bdcolliderdescendant " "

. global bdcolliders "ytminus1"

. 
. global long "v ytminus1"

. global all "v u ytminus1"

. 
. global mediator " "

. 
. *******************************************************************************
. *** regression estimators
. *******************************************************************************
. 
. regress $outcome $treatment

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(1, 999998)    >  99999.00
       Model |  718501.787         1  718501.787   Prob > F        =    0.0000
    Residual |  7153634.14   999,998  7.15364845   R-squared       =    0.0913
-------------+----------------------------------   Adj R-squared   =    0.0913
       Total |  7872135.93   999,999   7.8721438   Root MSE        =    2.6746

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           d |       1.84       0.01   316.92    0.00         1.83        1.86
       _cons |      19.74       0.00  6161.84    0.00        19.74       19.75
------------------------------------------------------------------------------

. regress $outcome $treatment $correct

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  1566071.79         2  783035.896   Prob > F        =    0.0000
    Residual |  6306064.14   999,997  6.30608306   R-squared       =    0.1989
-------------+----------------------------------   Adj R-squared   =    0.1989
       Total |  7872135.93   999,999   7.8721438   Root MSE        =    2.5112

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.01   169.24    0.00         0.99        1.01
           v |       1.00       0.00   366.61    0.00         0.99        1.00
       _cons |      20.00       0.00  6477.31    0.00        19.99       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $bdcolliders

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  5922179.61         2  2961089.81   Prob > F        =    0.0000
    Residual |  1949956.32   999,997  1.94996217   R-squared       =    0.7523
-------------+----------------------------------   Adj R-squared   =    0.7523
       Total |  7872135.93   999,999   7.8721438   Root MSE        =    1.3964

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           d |       0.70       0.00   225.38    0.00         0.70        0.71
    ytminus1 |       1.35       0.00  1633.59    0.00         1.35        1.35
       _cons |      20.09       0.00  1.2e+04    0.00        20.08       20.09
------------------------------------------------------------------------------

. regress $outcome $treatment $long

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(3, 999996)    >  99999.00
       Model |  6070019.01         3  2023339.67   Prob > F        =    0.0000
    Residual |  1802116.92   999,996  1.80212413   R-squared       =    0.7711
-------------+----------------------------------   Adj R-squared   =    0.7711
       Total |  7872135.93   999,999   7.8721438   Root MSE        =    1.3424

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   314.60    0.00         0.99        1.00
           v |      -0.50       0.00  -286.42    0.00        -0.50       -0.49
    ytminus1 |       1.50       0.00  1580.90    0.00         1.50        1.50
       _cons |      20.00       0.00  1.2e+04    0.00        19.99       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $all

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(4, 999995)    >  99999.00
       Model |   6568756.6         4  1642189.15   Prob > F        =    0.0000
    Residual |  1303379.34   999,995  1.30338585   R-squared       =    0.8344
-------------+----------------------------------   Adj R-squared   =    0.8344
       Total |  7872135.93   999,999   7.8721438   Root MSE        =    1.1417

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   369.67    0.00         0.99        1.00
           v |       0.00       0.00     0.96    0.34        -0.00        0.00
           u |       1.00       0.00   618.59    0.00         1.00        1.00
    ytminus1 |       1.00       0.00   876.39    0.00         1.00        1.00
       _cons |      20.00       0.00  1.4e+04    0.00        20.00       20.00
------------------------------------------------------------------------------

. 
. log close
      name:  <unnamed>
       log:  /Users/stephenmorgan/GitHub/steve-simulations/morgan-figure-4-3-sim-01.log
  log type:  text
 closed on:  21 Aug 2020, 16:49:33
----------------------------------------------------------------------------------------------------

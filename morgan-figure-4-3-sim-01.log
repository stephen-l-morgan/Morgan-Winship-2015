------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/smorgan/Documents/GitHub/Morgan-Winship-2015/morgan-figure-4-3-sim-01.log
  log type:  text
 opened on:  22 Jul 2022, 10:50:54

. 
. *******************************************************************************
. *** set the number of observations
. *******************************************************************************
. 
. set obs 1000000
Number of observations (_N) was 0, now 1,000,000.

. 
. *** Set seed for reproducibility (Steve's birthday. Don't forget it!)
. 
. set seed 73071

. 
. *******************************************************************************
. *** generate data
. *******************************************************************************
. 
. gen u = rnormal()

. gen v = rnormal()

. gen ytminus1 = u + v + rnormal()

. 
. gen dindex = -1 + v

. gen trueps = exp(dindex)/(1+exp(dindex))

. gen d = rbinomial(1, trueps)

. * gen d = v + rnormal() /* alternative linear d */
. 
. gen y0 = 20 + u + ytminus1 + rnormal()

. gen dshock = rnormal()

. gen ite = 1 + dshock

. gen y1 = y0 + ite

. gen y = (1-d)*y0 + d*y1

. * gen y = 10 + u + ytminus1 + d + rnormal() /* alternative w/o potential o's */
. 
. *******************************************************************************
. *** summary statistics for simulated data
. *******************************************************************************
. 
. summ

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           u |  1,000,000   -.0016039    .9999963  -5.302921   4.575489
           v |  1,000,000   -.0014839    .9995069   -5.06184   4.665742
    ytminus1 |  1,000,000   -.0034198    1.732469  -8.146265    7.98516
      dindex |  1,000,000   -1.001484    .9995069   -6.06184   3.665742
      trueps |  1,000,000    .3029763    .1824982   .0023247   .9750531
-------------+---------------------------------------------------------
           d |  1,000,000     .302921    .4595216          0          1
          y0 |  1,000,000     19.9957    2.645956   7.157038   32.67275
      dshock |  1,000,000   -.0001094    .9997408  -4.536191   4.934386
         ite |  1,000,000    .9998906    .9997408  -3.536191   5.934386
          y1 |  1,000,000    20.99559    2.827372   6.882687   35.04403
-------------+---------------------------------------------------------
           y |  1,000,000    20.29869    2.805285   7.157038   34.26192

. 
. /*
> preserve
> 
> sample 10000, count
> 
> dotplot u v ytminus1 d y
> graph export tmp431.pdf, replace
> 
> kdensity y, nograph generate(x fx)
> kdensity y if d==0, nograph generate(fx0) at(x)
> kdensity y if d==1, nograph generate(fx1) at(x)
> label var fx0 "Control"
> label var fx1 "Treatment"
> line fx0 fx1 x, sort ytitle(Density)
> graph export tmp432.pdf, replace
> 
> restore
> */
. 
. mean y0 ite y1 u v y ytminus1, over(d)

Mean estimation                      Number of obs = 1,000,000

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
      c.y0@d |
          0  |      19.74       0.00         19.73       19.75
          1  |      20.59       0.00         20.58       20.59
             |
     c.ite@d |
          0  |       1.00       0.00          1.00        1.00
          1  |       1.00       0.00          1.00        1.00
             |
      c.y1@d |
          0  |      20.74       0.00         20.73       20.75
          1  |      21.59       0.01         21.58       21.60
             |
       c.u@d |
          0  |      -0.00       0.00         -0.00       -0.00
          1  |       0.00       0.00         -0.00        0.00
             |
       c.v@d |
          0  |      -0.26       0.00         -0.26       -0.25
          1  |       0.59       0.00          0.58        0.59
             |
       c.y@d |
          0  |      19.74       0.00         19.73       19.75
          1  |      21.59       0.01         21.58       21.60
             |
c.ytminus1@d |
          0  |      -0.26       0.00         -0.26       -0.26
          1  |       0.59       0.00          0.58        0.59
--------------------------------------------------------------

. corr y0 ite y1 u v d y ytminus1
(obs=1,000,000)

             |       y0      ite       y1        u        v        d        y ytminus1
-------------+------------------------------------------------------------------------
          y0 |   1.0000
         ite |  -0.0012   1.0000
          y1 |   0.9354   0.3524   1.0000
           u |   0.7559  -0.0003   0.7073   1.0000
           v |   0.3773  -0.0016   0.3525  -0.0005   1.0000
           d |   0.1469   0.0002   0.1375   0.0014   0.3872   1.0000
           y |   0.9672   0.1064   0.9427   0.7131   0.4191   0.3024   1.0000
    ytminus1 |   0.8728  -0.0016   0.8162   0.5772   0.5769   0.2239   0.8598   1.0000


. 
. *******************************************************************************
. *** set up macros for specifications
. *******************************************************************************
. 
. global outcome "y"

. global treatment "d"

. 
. global short " "

. global correct "v"

. 
. global bdcolliderdescendant " "

. global bdcolliders "ytminus1"

. 
. global long "v ytminus1"

. global all "v u ytminus1"

. 
. global mediator " "

. 
. *******************************************************************************
. *** regression estimators
. *******************************************************************************
. 
. regress $outcome $treatment

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(1, 999998)    >  99999.00
       Model |  719488.194         1  719488.194   Prob > F        =    0.0000
    Residual |  7150128.66   999,998  7.15014296   R-squared       =    0.0914
-------------+----------------------------------   Adj R-squared   =    0.0914
       Total |  7869616.85   999,999  7.86962472   Root MSE        =     2.674

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.85       0.01   317.22    0.00         1.83        1.86
       _cons |      19.74       0.00  6163.40    0.00        19.73       19.75
------------------------------------------------------------------------------

. regress $outcome $treatment $correct

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  1563995.87         2  781997.935   Prob > F        =    0.0000
    Residual |  6305620.98   999,997   6.3056399   R-squared       =    0.1987
-------------+----------------------------------   Adj R-squared   =    0.1987
       Total |  7869616.85   999,999  7.86962472   Root MSE        =    2.5111

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.01       0.01   169.73    0.00         0.99        1.02
           v |       1.00       0.00   365.96    0.00         0.99        1.00
       _cons |      20.00       0.00  6475.54    0.00        19.99       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $bdcolliders

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  5917468.33         2  2958734.17   Prob > F        =    0.0000
    Residual |  1952148.52   999,997  1.95215438   R-squared       =    0.7519
-------------+----------------------------------   Adj R-squared   =    0.7519
       Total |  7869616.85   999,999  7.86962472   Root MSE        =    1.3972

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       0.71       0.00   226.28    0.00         0.70        0.71
    ytminus1 |       1.35       0.00  1631.77    0.00         1.35        1.35
       _cons |      20.09       0.00  1.2e+04    0.00        20.09       20.09
------------------------------------------------------------------------------

. regress $outcome $treatment $long

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(3, 999996)    >  99999.00
       Model |  6067555.25         3  2022518.42   Prob > F        =    0.0000
    Residual |   1802061.6   999,996  1.80206881   R-squared       =    0.7710
-------------+----------------------------------   Adj R-squared   =    0.7710
       Total |  7869616.85   999,999  7.86962472   Root MSE        =    1.3424

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   316.34    0.00         1.00        1.01
           v |      -0.50       0.00  -288.59    0.00        -0.51       -0.50
    ytminus1 |       1.50       0.00  1580.86    0.00         1.50        1.50
       _cons |      20.00       0.00  1.2e+04    0.00        20.00       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $all

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(4, 999995)    >  99999.00
       Model |  6567523.83         4  1641880.96   Prob > F        =    0.0000
    Residual |  1302093.02   999,995  1.30209953   R-squared       =    0.8345
-------------+----------------------------------   Adj R-squared   =    0.8345
       Total |  7869616.85   999,999  7.86962472   Root MSE        =    1.1411

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   371.10    0.00         0.99        1.00
           v |      -0.00       0.00    -0.71    0.48        -0.00        0.00
           u |       1.00       0.00   619.65    0.00         1.00        1.00
    ytminus1 |       1.00       0.00   877.22    0.00         1.00        1.00
       _cons |      20.00       0.00  1.4e+04    0.00        20.00       20.00
------------------------------------------------------------------------------

. 
. log close
      name:  <unnamed>
       log:  /Users/smorgan/Documents/GitHub/Morgan-Winship-2015/morgan-figure-4-3-sim-01.log
  log type:  text
 closed on:  22 Jul 2022, 10:50:57
------------------------------------------------------------------------------------------------------------------------

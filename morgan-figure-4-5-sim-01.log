------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/smorgan/Documents/GitHub/Morgan-Winship-2015/morgan-figure-4-5-sim-01.log
  log type:  text
 opened on:  22 Jul 2022, 10:51:05

. 
. *******************************************************************************
. *** set the number of observations
. *******************************************************************************
. 
. set obs 1000000
Number of observations (_N) was 0, now 1,000,000.

. 
. *** Set seed for reproducibility (Steve's birthday. Don't forget it!)
. 
. set seed 73071

. 
. *******************************************************************************
. *** generate data
. *******************************************************************************
. 
. gen u = rnormal()

. gen v = rnormal()

. gen ytminus2 = u + v + rnormal()

. 
. gen ytminus1 = ytminus2 + rnormal()

. 
. gen dindex = -1 + v

. gen trueps = exp(dindex)/(1+exp(dindex))

. gen d = rbinomial(1, trueps)

. * gen d = v + rnormal() /* alternative linear d */
. 
. gen y0 = 20 + u + ytminus1 + rnormal()

. gen dshock = rnormal()

. gen ite = 1 + dshock

. gen y1 = y0 + ite

. gen y = (1-d)*y0 + d*y1

. * gen y = 10 + u + ytminus1 + d + rnormal() /* alternative w/o potential o's */
. 
. *******************************************************************************
. *** summary statistics for simulated data
. *******************************************************************************
. 
. summ

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           u |  1,000,000   -.0016039    .9999963  -5.302921   4.575489
           v |  1,000,000   -.0014839    .9995069   -5.06184   4.665742
    ytminus2 |  1,000,000   -.0034198    1.732469  -8.146265    7.98516
    ytminus1 |  1,000,000   -.0033881    2.001605  -9.303715   10.71113
      dindex |  1,000,000   -1.001484    .9995069   -6.06184   3.665742
-------------+---------------------------------------------------------
      trueps |  1,000,000    .3029763    .1824982   .0023247   .9750531
           d |  1,000,000     .303521    .4597784          0          1
          y0 |  1,000,000     19.9949    2.831687   6.373368    33.8007
      dshock |  1,000,000    .0001802    .9995267  -4.890584   4.508399
         ite |  1,000,000     1.00018    .9995267  -3.890584   5.508399
-------------+---------------------------------------------------------
          y1 |  1,000,000    20.99508    3.003211   6.723144   36.22342
           y |  1,000,000    20.29815    2.980975   6.373368   36.22342

. 
. /*
> preserve
> 
> sample 10000, count
> 
> dotplot u v ytminus2 ytminus1 d y
> graph export tmp451.pdf, replace
> 
> kdensity y, nograph generate(x fx)
> kdensity y if d==0, nograph generate(fx0) at(x)
> kdensity y if d==1, nograph generate(fx1) at(x)
> label var fx0 "Control"
> label var fx1 "Treatment"
> line fx0 fx1 x, sort ytitle(Density)
> graph export tmp452.pdf, replace
> 
> restore
> */
. 
. mean y0 ite y1 u v y ytminus1 ytminus2, over(d)

Mean estimation                      Number of obs = 1,000,000

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
      c.y0@d |
          0  |      19.74       0.00         19.73       19.75
          1  |      20.58       0.01         20.57       20.59
             |
     c.ite@d |
          0  |       1.00       0.00          1.00        1.00
          1  |       1.00       0.00          1.00        1.00
             |
      c.y1@d |
          0  |      20.74       0.00         20.73       20.75
          1  |      21.58       0.01         21.57       21.59
             |
       c.u@d |
          0  |      -0.00       0.00         -0.00        0.00
          1  |      -0.00       0.00         -0.01       -0.00
             |
       c.v@d |
          0  |      -0.26       0.00         -0.26       -0.25
          1  |       0.59       0.00          0.58        0.59
             |
       c.y@d |
          0  |      19.74       0.00         19.73       19.75
          1  |      21.58       0.01         21.57       21.59
             |
c.ytminus1@d |
          0  |      -0.26       0.00         -0.26       -0.25
          1  |       0.58       0.00          0.58        0.59
             |
c.ytminus2@d |
          0  |      -0.26       0.00         -0.26       -0.25
          1  |       0.58       0.00          0.58        0.59
--------------------------------------------------------------

. corr y0 ite y1 u v d y ytminus1 ytminus2
(obs=1,000,000)

             |       y0      ite       y1        u        v        d        y ytminus1 ytminus2
-------------+---------------------------------------------------------------------------------
          y0 |   1.0000
         ite |   0.0003   1.0000
          y1 |   0.9430   0.3331   1.0000
           u |   0.7072   0.0008   0.6671   1.0000
           v |   0.3533  -0.0006   0.3329  -0.0005   1.0000
           d |   0.1367  -0.0007   0.1286  -0.0014   0.3874   1.0000
           y |   0.9709   0.1015   0.9493   0.6716   0.3956   0.2839   1.0000
    ytminus1 |   0.8840   0.0003   0.8336   0.4999   0.5000   0.1935   0.8697   1.0000
    ytminus2 |   0.8167   0.0002   0.7702   0.5772   0.5769   0.2233   0.8104   0.8662   1.0000


. 
. *******************************************************************************
. *** set up macros for specifications
. *******************************************************************************
. 
. global outcome "y"

. global treatment "d"

. 
. global short " "

. global correct "v"

. 
. global bdcolliderdescendant "ytminus1"

. global bdcolliders "ytminus2 ytminus1"

. 
. global long "v ytminus2 ytminus1"

. global all "v u ytminus2 ytminus1"

. 
. global mediator " "

. 
. *******************************************************************************
. *** regression estimators
. *******************************************************************************
. 
. regress $outcome $treatment

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(1, 999998)    =  87691.06
       Model |  716418.595         1  716418.595   Prob > F        =    0.0000
    Residual |  8169786.02   999,998  8.16980236   R-squared       =    0.0806
-------------+----------------------------------   Adj R-squared   =    0.0806
       Total |  8886204.61   999,999   8.8862135   Root MSE        =    2.8583

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.84       0.01   296.13    0.00         1.83        1.85
       _cons |      19.74       0.00  5763.44    0.00        19.73       19.75
------------------------------------------------------------------------------

. regress $outcome $treatment $correct

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  1569142.97         2  784571.484   Prob > F        =    0.0000
    Residual |  7317061.65   999,997   7.3170836   R-squared       =    0.1766
-------------+----------------------------------   Adj R-squared   =    0.1766
       Total |  8886204.61   999,999   8.8862135   Root MSE        =     2.705

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.01   156.21    0.00         0.98        1.01
           v |       1.00       0.00   341.38    0.00         1.00        1.01
       _cons |      20.00       0.00  6008.74    0.00        19.99       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $bdcolliderdescendant

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(2, 999997)    >  99999.00
       Model |  6844487.92         2  3422243.96   Prob > F        =    0.0000
    Residual |  2041716.69   999,997  2.04172282   R-squared       =    0.7702
-------------+----------------------------------   Adj R-squared   =    0.7702
       Total |  8886204.61   999,999   8.8862135   Root MSE        =    1.4289

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       0.78       0.00   245.99    0.00         0.77        0.79
    ytminus1 |       1.26       0.00  1732.46    0.00         1.26        1.26
       _cons |      20.07       0.00  1.2e+04    0.00        20.06       20.07
------------------------------------------------------------------------------

. regress $outcome $treatment $bdcolliders

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(3, 999996)    >  99999.00
       Model |  6936005.38         3  2312001.79   Prob > F        =    0.0000
    Residual |  1950199.24   999,996  1.95020704   R-squared       =    0.7805
-------------+----------------------------------   Adj R-squared   =    0.7805
       Total |  8886204.61   999,999   8.8862135   Root MSE        =    1.3965

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       0.70       0.00   225.42    0.00         0.70        0.71
    ytminus2 |       0.35       0.00   216.63    0.00         0.35        0.35
    ytminus1 |       1.00       0.00   716.36    0.00         1.00        1.00
       _cons |      20.09       0.00  1.2e+04    0.00        20.09       20.09
------------------------------------------------------------------------------

. regress $outcome $treatment $long

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(4, 999995)    >  99999.00
       Model |  7085214.97         4  1771303.74   Prob > F        =    0.0000
    Residual |  1800989.64   999,995  1.80099864   R-squared       =    0.7973
-------------+----------------------------------   Adj R-squared   =    0.7973
       Total |  8886204.61   999,999   8.8862135   Root MSE        =     1.342

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   315.34    0.00         0.99        1.00
           v |      -0.50       0.00  -287.83    0.00        -0.50       -0.50
    ytminus2 |       0.50       0.00   304.46    0.00         0.50        0.50
    ytminus1 |       1.00       0.00   745.64    0.00         1.00        1.00
       _cons |      20.00       0.00  1.2e+04    0.00        20.00       20.00
------------------------------------------------------------------------------

. regress $outcome $treatment $all

      Source |       SS           df       MS      Number of obs   = 1,000,000
-------------+----------------------------------   F(5, 999994)    >  99999.00
       Model |  7586640.71         5  1517328.14   Prob > F        =    0.0000
    Residual |  1299563.91   999,994   1.2995717   R-squared       =    0.8538
-------------+----------------------------------   Adj R-squared   =    0.8538
       Total |  8886204.61   999,999   8.8862135   Root MSE        =      1.14

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           d |       1.00       0.00   372.23    0.00         1.00        1.01
           v |      -0.00       0.00    -0.06    0.95        -0.00        0.00
           u |       1.00       0.00   621.16    0.00         1.00        1.00
    ytminus2 |       0.00       0.00     0.20    0.84        -0.00        0.00
    ytminus1 |       1.00       0.00   877.70    0.00         1.00        1.00
       _cons |      20.00       0.00  1.4e+04    0.00        20.00       20.00
------------------------------------------------------------------------------

. 
. log close
      name:  <unnamed>
       log:  /Users/smorgan/Documents/GitHub/Morgan-Winship-2015/morgan-figure-4-5-sim-01.log
  log type:  text
 closed on:  22 Jul 2022, 10:51:09
------------------------------------------------------------------------------------------------------------------------
